# 使用者權限管理

## 編輯軟體操作

nano 是一個簡單易用的文字編輯器，可在終端中輕鬆編輯文字檔。

> 若需要更高級的編輯功能可考慮 vim 或 emacs

- `nano [filename]`：打開編輯器
- `Ctrl + O`：保存文件
- `Ctrl + X`：退出編輯器
- `Ctrl + [N | P | B | F]`：向下/上/左/右移動一個字元
- `Ctrl + Shift + 方向鍵`：選擇文本範圍
- `Ctrl + K`：複製選擇的文本
- `Ctrl + U`：粘貼文本
- `Ctrl + 6`：上一步
- `Alt + 6`：恢復上一步
- `Ctrl + W`：查找文本
- `Ctrl + \`：替換文本
- `Ctrl + G`：幫助

## 使用者分類

Linux 是**多人系統**，意旨多位使用者共用一台電腦開發為前提，角色一般分成：

### 系統管理員

名稱為 root，個人目錄為 /root，有最高許可權，可執行任何操作。

`sudo` 可以在一般使用者的帳號使用 root 權限，但須事先在 /etc/sudoers 設定 wheel 群組。

```shell
sudo cat /etc/sudoers   # 查詢資訊
members sudo            # 查詢 sudo 群組資訊（在某些發行版非原生指令）
# 替代方案
getent group [group_name]
grep [group_name] /etc/group
sudo passwd root        # 修改 root 密碼
su -                    # 切換到 root 帳號
exit                    # 退出使用者
```

### 系統使用者

為了運行系統服務（Apache、Nginx、MySQL、Git 等）而創建的使用者，通常沒有登錄系統的許可權

### 一般使用者

只擁有部分許可權，擁有唯一的用戶名和主目錄（在 /home 之下），可以登錄系統，並創建和管理自己的檔案和目錄，但沒辦法執行對系統整體有影響的操作


## 檔案權限

分三種：

- 讀取 Read：符號 `r`，數字 `4`
- 寫入 Write：符號 `w`，數字 `2`
- 執行 Execute：符號 `x`，數字 `1`

> 無權限的符號 `-`、數字 `0`

### 符號表示法

由 10 個字元表示，例如：

```
-rwxr-xr-x
```

第一個字元表示檔案類型，`-` 普通檔案、`d` 目錄、`l` 符號連結等。

其餘 9 個字元三個一組，分別為檔案所有者、檔案所屬群組、其他用戶的許可權。 

### 數字表示法

由 3 個數字表示，由權限所代表的數字相加，例如：

```
755
```

### 變更權限

```shell
chmod [選項] 模式 檔案或目錄
```

選項：

- `-R` or `--recursive`：遞迴更改

模式用於表示該如何變更權限，通常由一系列許可權標誌組成。

使用符號模式，要搭配使用者標誌：

- `u`：擁有者
- `g`：所屬群組
- `o`：其他用戶
- `a`：所有用戶

範例：

- `chmod u+r file.txt`：檔案擁有者增加讀取權
- `chmod go-w file.txt`：所屬群組及其他使用者刪除寫入權

數字模式直接輸入 3 位數字：

```shell
chmod 755 file.txt
```

## 群組

Linux 以群組管理使用者，若無特別指定，使用者名稱為預設的群組名稱。

使用者可同時分屬多群組，多群組下會有主要群組。

### 指令

#### 顯示使用者所屬群組

```shell
groups [用戶名]
```

#### 顯示使用者的詳細資訊

此命令將顯示使用者的使用者 ID（UID）、群組ID（GID）、所屬主要群組和附加群組的詳細資訊。

```shell
id [用戶名]
```

## 使用者

### 指令

#### 新建使用者

```shell
sudo adduser [用戶名]
```

#### 變更使用者密碼

```shell
sudo passwd [用戶名]
```

#### 刪除使用者

```shell
sudo userdel [用戶名]
```

#### 查看當前使用者

```shell
whoami
```

#### 切換使用者

```shell
su [用戶名]
```

#### 查看使用者資訊

查看的資訊包含登陸時間、家目錄等。

```shell
finger [用戶名]
```

#### 查看最近登陸到系統的使用者清單

```shell
last
```

#### 修改使用者帳戶屬性

```shell
usermod [選項] 用戶名
```